<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"tusikalanse.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.14.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac","show_result":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="A. Lunar New Year and Cross Counting Description: Lunar New Year is approaching, and you bought a matrix with lots of &quot;crosses&quot;. This matrix \(M\) of size \(n \times n\) contains only &#39;X&#39; and &#39;.&#39; (wit"><meta property="og:type" content="article"><meta property="og:title" content="codeforces 1106题解"><meta property="og:url" content="https://tusikalanse.com/posts/cac007ef.html"><meta property="og:site_name" content="图斯卡蓝瑟的小站 计算机个人学习记录"><meta property="og:description" content="A. Lunar New Year and Cross Counting Description: Lunar New Year is approaching, and you bought a matrix with lots of &quot;crosses&quot;. This matrix \(M\) of size \(n \times n\) contains only &#39;X&#39; and &#39;.&#39; (wit"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-02-01T01:05:00.000Z"><meta property="article:modified_time" content="2019-02-01T01:05:00.000Z"><meta property="article:author" content="tusikalanse"><meta property="article:tag" content="codeforces"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://tusikalanse.com/posts/cac007ef.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://tusikalanse.com/posts/cac007ef.html","path":"posts/cac007ef.html","title":"codeforces 1106题解"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>codeforces 1106题解 | 图斯卡蓝瑟的小站 计算机个人学习记录</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><link rel="alternate" href="/atom.xml" title="图斯卡蓝瑟的小站 计算机个人学习记录" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">图斯卡蓝瑟的小站 计算机个人学习记录</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">陌生人，愿你在尘世获得幸福</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-random"><a href="/random.html" rel="section"><i class="fa fa-random fa-fw"></i>random</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-history fa-fw"></i>归档<span class="badge">37</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">12</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">4</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#a.-lunar-new-year-and-cross-counting"><span class="nav-number">1.</span> <span class="nav-text">A. Lunar New Year and Cross Counting</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description"><span class="nav-number">1.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output"><span class="nav-number">1.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input"><span class="nav-number">1.3.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output"><span class="nav-number">1.4.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-1"><span class="nav-number">1.5.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-1"><span class="nav-number">1.6.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-2"><span class="nav-number">1.7.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-2"><span class="nav-number">1.8.</span> <span class="nav-text">Sample Output:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5"><span class="nav-number">1.8.1.</span> <span class="nav-text">题目链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81"><span class="nav-number">1.9.</span> <span class="nav-text">AC代码:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#b.-lunar-new-year-and-food-ordering"><span class="nav-number">2.</span> <span class="nav-text">B. Lunar New Year and Food Ordering</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description-1"><span class="nav-number">2.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#input"><span class="nav-number">2.2.</span> <span class="nav-text">Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output-1"><span class="nav-number">2.3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-3"><span class="nav-number">2.4.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-3"><span class="nav-number">2.5.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-4"><span class="nav-number">2.6.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-4"><span class="nav-number">2.7.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-5"><span class="nav-number">2.8.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-5"><span class="nav-number">2.9.</span> <span class="nav-text">Sample Output:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-1"><span class="nav-number">2.9.1.</span> <span class="nav-text">题目链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81-1"><span class="nav-number">2.10.</span> <span class="nav-text">AC代码:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#c.-lunar-new-year-and-number-division"><span class="nav-number">3.</span> <span class="nav-text">C. Lunar New Year and Number Division</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description-2"><span class="nav-number">3.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#input-1"><span class="nav-number">3.2.</span> <span class="nav-text">Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output-2"><span class="nav-number">3.3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-6"><span class="nav-number">3.4.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-6"><span class="nav-number">3.5.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-7"><span class="nav-number">3.6.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-7"><span class="nav-number">3.7.</span> <span class="nav-text">Sample Output:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-2"><span class="nav-number">3.7.1.</span> <span class="nav-text">题目链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">3.8.</span> <span class="nav-text">题解:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81-2"><span class="nav-number">3.9.</span> <span class="nav-text">AC代码:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#d.-lunar-new-year-and-a-wander"><span class="nav-number">4.</span> <span class="nav-text">D. Lunar New Year and a Wander</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description-3"><span class="nav-number">4.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output-3"><span class="nav-number">4.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-8"><span class="nav-number">4.3.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-8"><span class="nav-number">4.4.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-9"><span class="nav-number">4.5.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-9"><span class="nav-number">4.6.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-10"><span class="nav-number">4.7.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-10"><span class="nav-number">4.8.</span> <span class="nav-text">Sample Output:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-3"><span class="nav-number">4.8.1.</span> <span class="nav-text">题目链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="nav-number">4.9.</span> <span class="nav-text">题解:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81-3"><span class="nav-number">4.10.</span> <span class="nav-text">AC代码:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#e.-lunar-new-year-and-red-envelopes"><span class="nav-number">5.</span> <span class="nav-text">E. Lunar New Year and Red Envelopes</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description-4"><span class="nav-number">5.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#input-2"><span class="nav-number">5.2.</span> <span class="nav-text">Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output-4"><span class="nav-number">5.3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-11"><span class="nav-number">5.4.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-11"><span class="nav-number">5.5.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-12"><span class="nav-number">5.6.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-13"><span class="nav-number">5.7.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-2"><span class="nav-number">5.8.</span> <span class="nav-text">题解:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81-4"><span class="nav-number">5.9.</span> <span class="nav-text">AC代码:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#f.-lunar-new-year-and-a-recursive-sequence"><span class="nav-number">6.</span> <span class="nav-text">F. Lunar New Year and a Recursive Sequence</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#description-5"><span class="nav-number">6.1.</span> <span class="nav-text">Description:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#input-3"><span class="nav-number">6.2.</span> <span class="nav-text">Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#output-5"><span class="nav-number">6.3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-12"><span class="nav-number">6.4.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-14"><span class="nav-number">6.5.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-13"><span class="nav-number">6.6.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-15"><span class="nav-number">6.7.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-14"><span class="nav-number">6.8.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-16"><span class="nav-number">6.9.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-15"><span class="nav-number">6.10.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-17"><span class="nav-number">6.11.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-16"><span class="nav-number">6.12.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-18"><span class="nav-number">6.13.</span> <span class="nav-text">Sample Output:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-input-17"><span class="nav-number">6.14.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sample-output-19"><span class="nav-number">6.15.</span> <span class="nav-text">Sample Output:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5-4"><span class="nav-number">6.15.1.</span> <span class="nav-text">题目链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3-3"><span class="nav-number">6.16.</span> <span class="nav-text">题解:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ac%E4%BB%A3%E7%A0%81-5"><span class="nav-number">6.17.</span> <span class="nav-text">AC代码:</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="tusikalanse" src="/images/avatar_AppleBloom.jpeg"><p class="site-author-name" itemprop="name">tusikalanse</p><div class="site-description" itemprop="description">每一个不曾起舞的日子，都是对生命的辜负</div></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/tusikalanse" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tusikalanse" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="mailto:tusikalanse@gmail.com" title="E-Mail → mailto:tusikalanse@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i></a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://tusikalanse.com/posts/cac007ef.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar_AppleBloom.jpeg"><meta itemprop="name" content="tusikalanse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="图斯卡蓝瑟的小站 计算机个人学习记录"><meta itemprop="description" content="每一个不曾起舞的日子，都是对生命的辜负"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="codeforces 1106题解 | 图斯卡蓝瑟的小站 计算机个人学习记录"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">codeforces 1106题解</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-02-01 09:05:00" itemprop="dateCreated datePublished" datetime="2019-02-01T09:05:00+08:00">2019-02-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>17k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>15 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="a.-lunar-new-year-and-cross-counting">A. Lunar New Year and Cross Counting</h1><h2 id="description">Description:</h2><p>Lunar New Year is approaching, and you bought a matrix with lots of "crosses". This matrix <span class="math inline">\(M\)</span> of size <span class="math inline">\(n \times n\)</span> contains only 'X' and '.' (without quotes). The element in the <span class="math inline">\(i\)</span>-th row and the <span class="math inline">\(j\)</span>-th column <span class="math inline">\((i, j)\)</span> is defined as <span class="math inline">\(M(i, j)\)</span>, where <span class="math inline">\(1 \leq i, j \leq n\)</span>. We define a cross appearing in the <span class="math inline">\(i\)</span>-th row and the <span class="math inline">\(j\)</span>-th column (<span class="math inline">\(1 &lt; i, j &lt; n\)</span>) if and only if $M(i, j) = M(i - 1, j - 1) = M(i - 1, j + 1) = M(i + 1, j - 1) = M(i + 1, j + 1) = $ 'X'. The following figure illustrates a cross appearing at position <span class="math inline">\((2, 2)\)</span> in a <span class="math inline">\(3 \times 3\)</span> matrix. X.X.X.X.X Your task is to find out the number of crosses in the given matrix <span class="math inline">\(M\)</span>. Two crosses are different if and only if they appear in different rows or columns. <span id="more"></span> ## Input: The first line contains only one positive integer <span class="math inline">\(n\)</span> (<span class="math inline">\(1 \leq n \leq 500\)</span>), denoting the size of the matrix <span class="math inline">\(M\)</span>. The following <span class="math inline">\(n\)</span> lines illustrate the matrix <span class="math inline">\(M\)</span>. Each line contains exactly <span class="math inline">\(n\)</span> characters, each of them is 'X' or '.'. The <span class="math inline">\(j\)</span>-th element in the <span class="math inline">\(i\)</span>-th line represents <span class="math inline">\(M(i, j)\)</span>, where <span class="math inline">\(1 \leq i, j \leq n\)</span>.</p><h2 id="output">Output</h2><p>Output a single line containing only one integer number <span class="math inline">\(k\)</span> — the number of crosses in the given matrix <span class="math inline">\(M\)</span>.</p><h2 id="sample-input">Sample Input:</h2><p>5 ..... .XXX. .XXX. .XXX. .....</p><h2 id="sample-output">Sample Output:</h2><p>1</p><h2 id="sample-input-1">Sample Input:</h2><p>2 XX XX</p><h2 id="sample-output-1">Sample Output:</h2><p>0</p><h2 id="sample-input-2">Sample Input:</h2><p>6 ...... X.X.X. .X.X.X X.X.X. .X.X.X ......</p><h2 id="sample-output-2">Sample Output:</h2><p>4</p><h3 id="题目链接"><a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/A">题目链接</a></h3><p>##题解:</p><p><span class="math inline">\(O(n^2)\)</span>暴力数一下就好了</p><h2 id="ac代码">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> g[<span class="number">510</span>][<span class="number">510</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;g[i][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span>(g[i][j] == <span class="string">&#x27;X&#x27;</span> &amp;&amp; g[i - <span class="number">1</span>][j - <span class="number">1</span>] == <span class="string">&#x27;X&#x27;</span> &amp;&amp; g[i - <span class="number">1</span>][j + <span class="number">1</span>] == <span class="string">&#x27;X&#x27;</span> &amp;&amp; g[i + <span class="number">1</span>][j - <span class="number">1</span>] == <span class="string">&#x27;X&#x27;</span> &amp;&amp; g[i + <span class="number">1</span>][j + <span class="number">1</span>] == <span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">				ans++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="b.-lunar-new-year-and-food-ordering">B. Lunar New Year and Food Ordering</h1><h2 id="description-1">Description:</h2><p>Lunar New Year is approaching, and Bob is planning to go for a famous restaurant — "Alice's". The restaurant "Alice's" serves <span class="math inline">\(n\)</span> kinds of food. The cost for the <span class="math inline">\(i\)</span>-th kind is always <span class="math inline">\(c_i\)</span>. Initially, the restaurant has enough ingredients for serving exactly <span class="math inline">\(a_i\)</span> dishes of the <span class="math inline">\(i\)</span>-th kind. In the New Year's Eve, <span class="math inline">\(m\)</span> customers will visit Alice's one after another and the <span class="math inline">\(j\)</span>-th customer will order <span class="math inline">\(d_j\)</span> dishes of the <span class="math inline">\(t_j\)</span>-th kind of food. The <span class="math inline">\((i + 1)\)</span>-st customer will only come after the <span class="math inline">\(i\)</span>-th customer is completely served. Suppose there are <span class="math inline">\(r_i\)</span> dishes of the <span class="math inline">\(i\)</span>-th kind remaining (initially <span class="math inline">\(r_i = a_i\)</span>). When a customer orders <span class="math inline">\(1\)</span> dish of the <span class="math inline">\(i\)</span>-th kind, the following principles will be processed. If <span class="math inline">\(r_i &gt; 0\)</span>, the customer will be served exactly <span class="math inline">\(1\)</span> dish of the <span class="math inline">\(i\)</span>-th kind. The cost for the dish is <span class="math inline">\(c_i\)</span>. Meanwhile, <span class="math inline">\(r_i\)</span> will be reduced by <span class="math inline">\(1\)</span>. Otherwise, the customer will be served <span class="math inline">\(1\)</span> dish of the cheapest available kind of food if there are any. If there are multiple cheapest kinds of food, the one with the smallest index among the cheapest will be served. The cost will be the cost for the dish served and the remain for the corresponding dish will be reduced by <span class="math inline">\(1\)</span>. If there are no more dishes at all, the customer will leave angrily. Therefore, no matter how many dishes are served previously, the cost for the customer is <span class="math inline">\(0\)</span>.If the customer doesn't leave after the <span class="math inline">\(d_j\)</span> dishes are served, the cost for the customer will be the sum of the cost for these <span class="math inline">\(d_j\)</span> dishes. Please determine the total cost for each of the <span class="math inline">\(m\)</span> customers.</p><h2 id="input">Input:</h2><p>The first line contains two integers <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> (<span class="math inline">\(1 \leq n, m \leq 10^5\)</span>), representing the number of different kinds of food and the number of customers, respectively. The second line contains <span class="math inline">\(n\)</span> positive integers <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> (<span class="math inline">\(1 \leq a_i \leq 10^7\)</span>), where <span class="math inline">\(a_i\)</span> denotes the initial remain of the <span class="math inline">\(i\)</span>-th kind of dishes. The third line contains <span class="math inline">\(n\)</span> positive integers <span class="math inline">\(c_1, c_2, \ldots, c_n\)</span> (<span class="math inline">\(1 \leq c_i \leq 10^6\)</span>), where <span class="math inline">\(c_i\)</span> denotes the cost of one dish of the <span class="math inline">\(i\)</span>-th kind. The following <span class="math inline">\(m\)</span> lines describe the orders of the <span class="math inline">\(m\)</span> customers respectively. The <span class="math inline">\(j\)</span>-th line contains two positive integers <span class="math inline">\(t_j\)</span> and <span class="math inline">\(d_j\)</span> (<span class="math inline">\(1 \leq t_j \leq n\)</span>, <span class="math inline">\(1 \leq d_j \leq 10^7\)</span>), representing the kind of food and the number of dishes the <span class="math inline">\(j\)</span>-th customer orders, respectively.</p><h2 id="output-1">Output</h2><p>Print <span class="math inline">\(m\)</span> lines. In the <span class="math inline">\(j\)</span>-th line print the cost for the <span class="math inline">\(j\)</span>-th customer.</p><h2 id="sample-input-3">Sample Input:</h2><p>8 5 8 6 2 1 4 5 7 5 6 3 3 2 6 2 3 2 2 8 1 4 4 7 3 4 6 10</p><h2 id="sample-output-3">Sample Output:</h2><p>22 24 14 10 39</p><h2 id="sample-input-4">Sample Input:</h2><p>6 6 6 6 6 6 6 6 6 66 666 6666 66666 666666 1 6 2 6 3 6 4 6 5 6 6 66</p><h2 id="sample-output-4">Sample Output:</h2><p>36 396 3996 39996 399996 0</p><h2 id="sample-input-5">Sample Input:</h2><p>6 6 6 6 6 6 6 6 6 66 666 6666 66666 666666 1 6 2 13 3 6 4 11 5 6 6 6</p><h2 id="sample-output-5">Sample Output:</h2><p>36 11058 99996 4333326 0 0</p><h3 id="题目链接-1"><a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/B">题目链接</a></h3><p>##题解:</p><p>模拟一下，<span class="math inline">\(O((n+m)log(n))\)</span></p><h2 id="ac代码-1">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, a[N], c[N], t, d, cnt;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> cost, id;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> node &amp;rhs) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(cost == rhs.cost)</span><br><span class="line">			<span class="keyword">return</span> id &lt; rhs.id;</span><br><span class="line">		<span class="keyword">return</span> cost &lt; rhs.cost;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;temp;</span><br><span class="line"></span><br><span class="line">map&lt;node, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</span><br><span class="line">		temp.cost = c[i];</span><br><span class="line">		temp.id = i;</span><br><span class="line">		mp[temp] = a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;t, &amp;d);</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">		temp.cost = c[t], temp.id = t;</span><br><span class="line">		<span class="keyword">if</span>(mp.<span class="built_in">find</span>(temp) != mp.<span class="built_in">end</span>()) &#123;</span><br><span class="line">			cnt = <span class="built_in">min</span>(mp[temp], d);</span><br><span class="line">			d -= cnt;</span><br><span class="line">			mp[temp] -= cnt;</span><br><span class="line">			ans += <span class="number">1LL</span> * cnt * temp.cost;</span><br><span class="line">			<span class="keyword">if</span>(mp[temp] == <span class="number">0</span>)</span><br><span class="line">				mp.<span class="built_in">erase</span>(temp);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span>(d &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(mp.<span class="built_in">empty</span>()) <span class="keyword">break</span>;</span><br><span class="line">			temp = mp.<span class="built_in">begin</span>()-&gt;first;</span><br><span class="line">			cnt = <span class="built_in">min</span>(mp[temp], d);</span><br><span class="line">			d -= cnt;</span><br><span class="line">			mp[temp] -= cnt;</span><br><span class="line">			ans += <span class="number">1LL</span> * cnt * temp.cost;</span><br><span class="line">			<span class="keyword">if</span>(mp[temp] == <span class="number">0</span>)</span><br><span class="line">				mp.<span class="built_in">erase</span>(temp);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">if</span>(d != <span class="number">0</span>)</span><br><span class="line">			ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="c.-lunar-new-year-and-number-division">C. Lunar New Year and Number Division</h1><h2 id="description-2">Description:</h2><p>Lunar New Year is approaching, and Bob is struggling with his homework – a number division problem. There are <span class="math inline">\(n\)</span> positive integers <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> on Bob's homework paper, where <span class="math inline">\(n\)</span> is always an even number. Bob is asked to divide those numbers into groups, where each group must contain at least <span class="math inline">\(2\)</span> numbers. Suppose the numbers are divided into <span class="math inline">\(m\)</span> groups, and the sum of the numbers in the <span class="math inline">\(j\)</span>-th group is <span class="math inline">\(s_j\)</span>. Bob's aim is to minimize the sum of the square of <span class="math inline">\(s_j\)</span>, that is <span class="math inline">\(\sum_{j = 1}^{m} s_j^2.\)</span> Bob is puzzled by this hard problem. Could you please help him solve it?</p><h2 id="input-1">Input:</h2><p>The first line contains an even integer <span class="math inline">\(n\)</span> (<span class="math inline">\(2 \leq n \leq 3 \cdot 10^5\)</span>), denoting that there are <span class="math inline">\(n\)</span> integers on Bob's homework paper. The second line contains <span class="math inline">\(n\)</span> integers <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> (<span class="math inline">\(1 \leq a_i \leq 10^4\)</span>), describing the numbers you need to deal with.</p><h2 id="output-2">Output</h2><p>A single line containing one integer, denoting the minimum of the sum of the square of <span class="math inline">\(s_j\)</span>, which is <span class="math inline">\(\sum_{i = j}^{m} s_j^2,\)</span> where <span class="math inline">\(m\)</span> is the number of groups.</p><h2 id="sample-input-6">Sample Input:</h2><p>4 8 5 2 3</p><h2 id="sample-output-6">Sample Output:</h2><p>164</p><h2 id="sample-input-7">Sample Input:</h2><p>6 1 1 1 2 2 2</p><h2 id="sample-output-7">Sample Output:</h2><p>27</p><h3 id="题目链接-2"><a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/C">题目链接</a></h3><h2 id="题解">题解:</h2><p>显然两个两个一起最小，不难看出最小的和最大的匹配总和最小，<span class="math inline">\(O(nlog(n))\)</span></p><h2 id="ac代码-2">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N], n, tmp;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; <span class="number">2</span> * i &lt;= n; ++i) &#123;</span><br><span class="line">		tmp = a[i] + a[n + <span class="number">1</span> - i];</span><br><span class="line">		ans += <span class="number">1LL</span> * tmp * tmp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="d.-lunar-new-year-and-a-wander">D. Lunar New Year and a Wander</h1><h2 id="description-3">Description:</h2><p>Lunar New Year is approaching, and Bob decides to take a wander in a nearby park. The park can be represented as a connected graph with <span class="math inline">\(n\)</span> nodes and <span class="math inline">\(m\)</span> bidirectional edges. Initially Bob is at the node <span class="math inline">\(1\)</span> and he records <span class="math inline">\(1\)</span> on his notebook. He can wander from one node to another through those bidirectional edges. Whenever he visits a node not recorded on his notebook, he records it. After he visits all nodes at least once, he stops wandering, thus finally a permutation of nodes <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> is recorded. Wandering is a boring thing, but solving problems is fascinating. Bob wants to know the lexicographically smallest sequence of nodes he can record while wandering. Bob thinks this problem is trivial, and he wants you to solve it. A sequence <span class="math inline">\(x\)</span> is lexicographically smaller than a sequence <span class="math inline">\(y\)</span> if and only if one of the following holds: <span class="math inline">\(x\)</span> is a prefix of <span class="math inline">\(y\)</span>, but <span class="math inline">\(x \ne y\)</span> (this is impossible in this problem as all considered sequences have the same length); in the first position where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> differ, the sequence <span class="math inline">\(x\)</span> has a smaller element than the corresponding element in <span class="math inline">\(y\)</span>. ## Input: The first line contains two positive integers <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> (<span class="math inline">\(1 \leq n, m \leq 10^5\)</span>), denoting the number of nodes and edges, respectively. The following <span class="math inline">\(m\)</span> lines describe the bidirectional edges in the graph. The <span class="math inline">\(i\)</span>-th of these lines contains two integers <span class="math inline">\(u_i\)</span> and <span class="math inline">\(v_i\)</span> (<span class="math inline">\(1 \leq u_i, v_i \leq n\)</span>), representing the nodes the <span class="math inline">\(i\)</span>-th edge connects. Note that the graph can have multiple edges connecting the same two nodes and self-loops. It is guaranteed that the graph is connected.</p><h2 id="output-3">Output</h2><p>Output a line containing the lexicographically smallest sequence <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> Bob can record.</p><h2 id="sample-input-8">Sample Input:</h2><p>3 2 1 2 1 3</p><h2 id="sample-output-8">Sample Output:</h2><p>1 2 3</p><h2 id="sample-input-9">Sample Input:</h2><p>5 5 1 4 3 4 5 4 3 2 1 5</p><h2 id="sample-output-9">Sample Output:</h2><p>1 4 3 2 5</p><h2 id="sample-input-10">Sample Input:</h2><p>10 10 1 4 6 8 2 5 3 7 9 4 5 6 3 4 8 10 8 9 1 10</p><h2 id="sample-output-10">Sample Output:</h2><p>1 4 3 7 9 8 6 5 2 10</p><h3 id="题目链接-3"><a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/D">题目链接</a></h3><h2 id="题解-1">题解:</h2><p>一开始在点1, 每次第一次到达一个点记录到答案，求字典序最小的答案序列</p><p>类似Prim的思想，每次取最小的，用优先队列实现，<span class="math inline">\(O(nlog(m))\)</span></p><h2 id="ac代码-3">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, vector&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; pq;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N], vis[N], pnt[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], cnt, n, m, x, y;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	pnt[cnt] = y;</span><br><span class="line">	nxt[cnt] = head[x];</span><br><span class="line">	head[x] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(head));</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">		<span class="built_in">add</span>(x, y);</span><br><span class="line">		<span class="built_in">add</span>(y, x);</span><br><span class="line">	&#125;</span><br><span class="line">	pq.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">while</span>(!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">		<span class="keyword">int</span> t = pq.<span class="built_in">top</span>();</span><br><span class="line">		pq.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[t]) <span class="keyword">continue</span>;</span><br><span class="line">		vis[t] = <span class="number">1</span>;</span><br><span class="line">		ans.<span class="built_in">push_back</span>(t);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = head[t]; ~i; i = nxt[i]) &#123;</span><br><span class="line">			<span class="keyword">int</span> j = pnt[i];</span><br><span class="line">			<span class="keyword">if</span>(vis[j]) <span class="keyword">continue</span>;</span><br><span class="line">			pq.<span class="built_in">push</span>(j);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ans.<span class="built_in">size</span>(); ++i)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, ans[i], <span class="string">&quot; \n&quot;</span>[i == ans.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="e.-lunar-new-year-and-red-envelopes">E. Lunar New Year and Red Envelopes</h1><h2 id="description-4">Description:</h2><p>Lunar New Year is approaching, and Bob is going to receive some red envelopes with countless money! But collecting money from red envelopes is a time-consuming process itself. Let's describe this problem in a mathematical way. Consider a timeline from time <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. The <span class="math inline">\(i\)</span>-th red envelope will be available from time <span class="math inline">\(s_i\)</span> to <span class="math inline">\(t_i\)</span>, inclusive, and contain <span class="math inline">\(w_i\)</span> coins. If Bob chooses to collect the coins in the <span class="math inline">\(i\)</span>-th red envelope, he can do it only in an integer point of time between <span class="math inline">\(s_i\)</span> and <span class="math inline">\(t_i\)</span>, inclusive, and he can't collect any more envelopes until time <span class="math inline">\(d_i\)</span> (inclusive) after that. Here <span class="math inline">\(s_i \leq t_i \leq d_i\)</span> holds. Bob is a greedy man, he collects coins greedily — whenever he can collect coins at some integer time <span class="math inline">\(x\)</span>, he collects the available red envelope with the maximum number of coins. If there are multiple envelopes with the same maximum number of coins, Bob would choose the one whose parameter <span class="math inline">\(d\)</span> is the largest. If there are still multiple choices, Bob will choose one from them randomly. However, Alice — his daughter — doesn't want her father to get too many coins. She could disturb Bob at no more than <span class="math inline">\(m\)</span> integer time moments. If Alice decides to disturb Bob at time <span class="math inline">\(x\)</span>, he could not do anything at time <span class="math inline">\(x\)</span> and resumes his usual strategy at the time <span class="math inline">\(x + 1\)</span> (inclusive), which may lead to missing some red envelopes. Calculate the minimum number of coins Bob would get if Alice disturbs him optimally.</p><h2 id="input-2">Input:</h2><p>The first line contains three non-negative integers <span class="math inline">\(n\)</span>, <span class="math inline">\(m\)</span> and <span class="math inline">\(k\)</span> (<span class="math inline">\(1 \leq n \leq 10^5\)</span>, <span class="math inline">\(0 \leq m \leq 200\)</span>, <span class="math inline">\(1 \leq k \leq 10^5\)</span>), denoting the length of the timeline, the number of times Alice can disturb Bob and the total number of red envelopes, respectively. The following <span class="math inline">\(k\)</span> lines describe those <span class="math inline">\(k\)</span> red envelopes. The <span class="math inline">\(i\)</span>-th line contains four positive integers <span class="math inline">\(s_i\)</span>, <span class="math inline">\(t_i\)</span>, <span class="math inline">\(d_i\)</span> and <span class="math inline">\(w_i\)</span> (<span class="math inline">\(1 \leq s_i \leq t_i \leq d_i \leq n\)</span>, <span class="math inline">\(1 \leq w_i \leq 10^9\)</span>) — the time segment when the <span class="math inline">\(i\)</span>-th envelope is available, the time moment Bob can continue collecting after collecting the <span class="math inline">\(i\)</span>-th envelope, and the number of coins in this envelope, respectively.</p><h2 id="output-4">Output</h2><p>Output one integer — the minimum number of coins Bob would get if Alice disturbs him optimally.</p><h2 id="sample-input-11">Sample Input:</h2><p>5 0 2 1 3 4 5 2 5 5 8</p><h2 id="sample-output-11">Sample Output:</h2><p>13 ## Sample Input:</p><p>10 1 6 1 1 2 4 2 2 6 2 3 3 3 3 4 4 4 5 5 5 5 7 6 6 6 9</p><h2 id="sample-output-12">Sample Output:</h2><p>2 ## Sample Input:</p><p>12 2 6 1 5 5 4 4 6 6 2 3 8 8 3 2 9 9 5 6 10 10 7 8 12 12 9</p><h2 id="sample-output-13">Sample Output:</h2><p>11 ### <a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/E">题目链接</a></p><h2 id="题解-2">题解:</h2><p><span class="math inline">\(k\)</span>个红包，每个可以在<span class="math inline">\(l_i到r_i的整点选取，价值为w_i, 选取后直到d_i不能选红包\)</span>，你的策略是任意时刻选价值最高的，有多个则选<span class="math inline">\(d_i\)</span>最大的，还有多个则随机（其实是选什么都一样），你可以被人打扰m次，一次打扰则在一个时刻不能选红包，求选择红包总价值的最小值</p><p><span class="math inline">\(O(n \ast m)\)</span>dp即可</p><h2 id="ac代码-4">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">LL dp[N][<span class="number">220</span>], sum[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> l, r, d, w, nxt, val, n, m, k;</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; tmp;</span><br><span class="line">vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; t[N], s[N];</span><br><span class="line">multiset&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;d, &amp;w);</span><br><span class="line">		tmp.first = -w, tmp.second = -d;</span><br><span class="line">		s[r].<span class="built_in">push_back</span>(tmp);</span><br><span class="line">		t[l].<span class="built_in">push_back</span>(tmp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">memset</span>(dp[n + <span class="number">1</span>], <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(dp[n + <span class="number">1</span>]));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; i; --i) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;it: s[i])</span><br><span class="line">			mp.<span class="built_in">insert</span>(it);</span><br><span class="line">		<span class="keyword">if</span>(!mp.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">			tmp = *mp.<span class="built_in">begin</span>();</span><br><span class="line">			nxt = -tmp.second + <span class="number">1</span>;</span><br><span class="line">			val = -tmp.first;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			nxt = i + <span class="number">1</span>;</span><br><span class="line">			val = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">			dp[i][j] = dp[nxt][j] + val;</span><br><span class="line">			<span class="keyword">if</span>(j)</span><br><span class="line">				dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i + <span class="number">1</span>][j - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;it: t[i]) &#123;</span><br><span class="line">			mp.<span class="built_in">erase</span>(mp.<span class="built_in">find</span>(it));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dp[<span class="number">1</span>][m]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="f.-lunar-new-year-and-a-recursive-sequence">F. Lunar New Year and a Recursive Sequence</h1><h2 id="description-5">Description:</h2><p>Lunar New Year is approaching, and Bob received a gift from his friend recently — a recursive sequence! He loves this sequence very much and wants to play with it. Let <span class="math inline">\(f_1, f_2, \ldots, f_i, \ldots\)</span> be an infinite sequence of positive integers. Bob knows that for <span class="math inline">\(i &gt; k\)</span>, <span class="math inline">\(f_i\)</span> can be obtained by the following recursive equation: <span class="math inline">\(f_i = \left(f_{i - 1} ^ {b_1} \cdot f_{i - 2} ^ {b_2} \cdot \cdots \cdot f_{i - k} ^ {b_k}\right) \bmod p,\)</span> which in short is <span class="math inline">\(f_i = \left(\prod_{j = 1}^{k} f_{i - j}^{b_j}\right) \bmod p,\)</span> where <span class="math inline">\(p = 998\,244\,353\)</span> (a widely-used prime), <span class="math inline">\(b_1, b_2, \ldots, b_k\)</span> are known integer constants, and <span class="math inline">\(x \bmod y\)</span> denotes the remainder of <span class="math inline">\(x\)</span> divided by <span class="math inline">\(y\)</span>. Bob lost the values of <span class="math inline">\(f_1, f_2, \ldots, f_k\)</span>, which is extremely troublesome – these are the basis of the sequence! Luckily, Bob remembers the first <span class="math inline">\(k - 1\)</span> elements of the sequence: <span class="math inline">\(f_1 = f_2 = \ldots = f_{k - 1} = 1\)</span> and the <span class="math inline">\(n\)</span>-th element: <span class="math inline">\(f_n = m\)</span>. Please find any possible value of <span class="math inline">\(f_k\)</span>. If no solution exists, just tell Bob that it is impossible to recover his favorite sequence, regardless of Bob's sadness.</p><h2 id="input-3">Input:</h2><p>The first line contains a positive integer <span class="math inline">\(k\)</span> (<span class="math inline">\(1 \leq k \leq 100\)</span>), denoting the length of the sequence <span class="math inline">\(b_1, b_2, \ldots, b_k\)</span>. The second line contains <span class="math inline">\(k\)</span> positive integers <span class="math inline">\(b_1, b_2, \ldots, b_k\)</span> (<span class="math inline">\(1 \leq b_i &lt; p\)</span>). The third line contains two positive integers <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> (<span class="math inline">\(k &lt; n \leq 10^9\)</span>, <span class="math inline">\(1 \leq m &lt; p\)</span>), which implies <span class="math inline">\(f_n = m\)</span>.</p><h2 id="output-5">Output</h2><p>Output a possible value of <span class="math inline">\(f_k\)</span>, where <span class="math inline">\(f_k\)</span> is a positive integer satisfying <span class="math inline">\(1 \leq f_k &lt; p\)</span>. If there are multiple answers, print any of them. If no such <span class="math inline">\(f_k\)</span> makes <span class="math inline">\(f_n = m\)</span>, output <span class="math inline">\(-1\)</span> instead. It is easy to show that if there are some possible values of <span class="math inline">\(f_k\)</span>, there must be at least one satisfying <span class="math inline">\(1 \leq f_k &lt; p\)</span>.</p><h2 id="sample-input-12">Sample Input:</h2><p>3 2 3 5 4 16</p><h2 id="sample-output-14">Sample Output:</h2><p>4</p><h2 id="sample-input-13">Sample Input:</h2><p>5 4 7 1 5 6 7 14187219</p><h2 id="sample-output-15">Sample Output:</h2><p>6</p><h2 id="sample-input-14">Sample Input:</h2><p>8 2 3 5 6 1 7 9 10 23333 1</p><h2 id="sample-output-16">Sample Output:</h2><p>1</p><h2 id="sample-input-15">Sample Input:</h2><p>1 2 88888 66666</p><h2 id="sample-output-17">Sample Output:</h2><p>-1</p><h2 id="sample-input-16">Sample Input:</h2><p>3 998244352 998244352 998244352 4 2</p><h2 id="sample-output-18">Sample Output:</h2><p>-1</p><h2 id="sample-input-17">Sample Input:</h2><p>10 283 463 213 777 346 201 463 283 102 999 2333333 6263423</p><h2 id="sample-output-19">Sample Output:</h2><p>382480067</p><h3 id="题目链接-4"><a target="_blank" rel="noopener" href="http://codeforces.com/contest/1106/problem/F">题目链接</a></h3><h2 id="题解-3">题解:</h2><p>把原式看成<span class="math inline">\(f_k\)</span>的幂次的形式，设<span class="math inline">\(f_n=f_k^{h_n}\)</span>, 则<span class="math inline">\(h_1=h_2=...=h_{k-1}=0, h_k=1\)</span>, <span class="math inline">\(h_i = \sum_{j = 1}^k(h_{i-j} \ast b_j) \ mod \ \phi(p), (i &gt; k时)\)</span>,用矩阵快速幂可以求解出<span class="math inline">\(h_n\)</span>, 时间复杂度为<span class="math inline">\(O(k^3log(n))\)</span>,</p><p>然后要求解<span class="math inline">\(f_k^{h_n} = m \ mod \ p\)</span>, 这个叫高次剩余，告辞！，可以利用<span class="math inline">\(p=998244353\)</span>的性质利用原根求解，</p><p>令<span class="math inline">\(m = g ^ x\)</span>, 其中g为p的原根3, 利用<span class="math inline">\(BSGS\)</span>算法可以<span class="math inline">\(O(\sqrt plog(p))\)</span>算出x(用哈希表代替map可以去掉一个log),</p><p>设<span class="math inline">\(f_k = g^y\)</span>, 则<span class="math inline">\(g^{y \ast h_n} = g^x \ mod \ p, 则y \ast h_n=x \ mod \ \phi(p)\)</span>,利用<span class="math inline">\(EXGCD\)</span>解出y</p><p>总复杂度<span class="math inline">\(O(k^3log(n) + \sqrt plog(p))\)</span></p><h2 id="ac代码-5">AC代码:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="keyword">int</span> b[N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Mat</span> &#123;</span></span><br><span class="line">	LL a[N][N];</span><br><span class="line">	<span class="built_in">Mat</span>(<span class="keyword">bool</span> flag = <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(a));</span><br><span class="line">		<span class="keyword">if</span>(flag)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">				a[i][i] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	LL* <span class="keyword">operator</span>[](<span class="keyword">unsigned</span> id) &#123;</span><br><span class="line">		<span class="keyword">return</span> a[id];</span><br><span class="line">	&#125;</span><br><span class="line">	Mat <span class="keyword">operator</span>*(Mat &amp;rhs) &#123;</span><br><span class="line">		Mat res;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; ++j) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; k; ++p) &#123;</span><br><span class="line">					res[i][j] = (res[i][j] + a[i][p] * rhs[p][j]) % (mod - <span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;base;</span><br><span class="line"></span><br><span class="line"><span class="function">Mat <span class="title">Mat_qp</span><span class="params">(Mat a, LL n)</span> </span>&#123;</span><br><span class="line">	<span class="function">Mat <span class="title">res</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(n) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n &amp; <span class="number">1</span>)</span><br><span class="line">			res = res * a;</span><br><span class="line">		a = a * a;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">qp</span><span class="params">(LL a, LL n, LL m = mod)</span> </span>&#123;</span><br><span class="line">	LL res = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(n) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n &amp; <span class="number">1</span>)</span><br><span class="line">			res = res * a % m;</span><br><span class="line">		a = a * a % m;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">BSGS</span><span class="params">(LL A, LL B, LL C)</span> </span>&#123; <span class="comment">//find minium x satisfy A ** x % C = B % C </span></span><br><span class="line">	map&lt;LL, LL&gt; mp;</span><br><span class="line">	<span class="keyword">if</span>(A % C == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	LL m = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(C)); <span class="comment">//x = i * m - j, A ** (i * m - j) = B, A ** (i * m) = B * A ** j</span></span><br><span class="line">	LL ans = B % C;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123; <span class="comment">//enum j</span></span><br><span class="line">		mp[ans] = j;</span><br><span class="line">		ans = ans * A % C;		</span><br><span class="line">	&#125;</span><br><span class="line">	LL t = <span class="built_in">qp</span>(A, m, C);</span><br><span class="line">	ans = t;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123; <span class="comment">//enum i, find j</span></span><br><span class="line">		<span class="keyword">if</span>(mp.<span class="built_in">count</span>(ans)) </span><br><span class="line">			<span class="keyword">return</span> ((i * m - mp[ans]) % C + C) % C;</span><br><span class="line">		ans = ans * t % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">exgcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y)</span> </span>&#123;<span class="comment">//x, y must be reference, ax + by = gcd(a, b)</span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>) &#123;</span><br><span class="line">    	x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    LL d = <span class="built_in">exgcd</span>(b, a % b, x, y);</span><br><span class="line">    LL t = x;</span><br><span class="line">    x = y, y = t - (a / b) * y;</span><br><span class="line">    <span class="keyword">return</span> d; <span class="comment">//d = gcd(a, b)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">solve</span><span class="params">(LL t, LL p)</span> </span>&#123;</span><br><span class="line">	LL x, y;</span><br><span class="line">	LL d = <span class="built_in">exgcd</span>(t, mod - <span class="number">1</span>, x, y);</span><br><span class="line">	<span class="keyword">if</span>(p % d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	x = ((x * p / d) % (mod - <span class="number">1</span>) + (mod - <span class="number">1</span>)) % (mod - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">qp</span>(<span class="number">3</span>, x, mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;base[<span class="number">0</span>][i]);</span><br><span class="line">		base[i + <span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">	Mat jar = <span class="built_in">Mat_qp</span>(base, n - k);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">solve</span>(jar[<span class="number">0</span>][<span class="number">0</span>], <span class="built_in">BSGS</span>(<span class="number">3</span>, m, mod)));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-tags"><a href="/tags/codeforces/" rel="tag"><i class="fa fa-tag"></i> codeforces</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/cb96abfa.html" rel="prev" title="线段树优化建图(cf787d, 2019Wannafly Winter Camp Day7 Div1 E)"><i class="fa fa-chevron-left"></i> 线段树优化建图(cf787d, 2019Wannafly Winter Camp Day7 Div1 E)</a></div><div class="post-nav-item"><a href="/posts/32a1b255.html" rel="next" title="Codeforces 1107E Vasya and Binary String 记忆化dp">Codeforces 1107E Vasya and Binary String 记忆化dp <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><div id="twikoo-comments"></div></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备2021179099号</a></div><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">tusikalanse</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">206k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">3:08</span></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div></div></footer><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a href="https://github.com/tusikalanse" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script src="/js/third-party/fancybox.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script><script class="next-config" data-name="twikoo" type="application/json">{"enable":true,"visitor":false,"envId":"cloudbase-prepaid-7em17x0a415065","region":"ap-guangzhou","el":"#twikoo-comments"}</script><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});</script></body></html>